<!DOCTYPE html>
<html>

<head>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <%- include('../components/navbar') %>
    <title>Data Analytics</title>
</head>

<style>
  * {
    box-sizing: border-box;
  }

  .row {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
  
  }

  .column {
    flex: 50%;
    padding: 10px;
    max-width: 100%;
   
  }

  iframe {
    width: 100%;
    height: 440px;
    max-width: 840px;
   
  }

  .myChart {
    width: 100%;
    height: 50%;
    max-height: 500px;
    max-width: 840px;
   background-color: white;
  }


</style>


<body class="bg-pnp">

  <div class="main">
    <div class="title"
      style="background-color: #0a15ab; color: white; font-size: 32px; text-align: left; padding: 20px;">
      <h1>Data Analytics</h1>
    </div>
    <div class="chart-container" style="background: #0a15ab; padding: 20px;">
      <div class="row">
        <div class="column">
          <h2 class="chart-title" style="color: white;">Total Number of Firearms</h2>
          <iframe
            style="background: #FFFFFF;border: none;border-radius: 2px;box-shadow: 0 2px 10px 0 rgba(70, 76, 79, .2);"
            src="https://charts.mongodb.com/charts-project-0-omorz/embed/charts?id=6492abe4-74f2-4905-805e-f685c6754286&maxDataAge=3600&theme=light&autoRefresh=true"></iframe>
        </div>

        <div class="column">
          <h2 class="chart-title" style="color: white;">Total Cost of Firearms</h2>
          <iframe
            style="background: #FFFFFF;border: none;border-radius: 2px;box-shadow: 0 2px 10px 0 rgba(70, 76, 79, .2);"
            src="https://charts.mongodb.com/charts-project-0-omorz/embed/charts?id=64994e7e-6f89-4b9b-8926-e4595ee18be1&maxDataAge=3600&theme=light&autoRefresh=true"></iframe>
        </div>
      </div>


      <div class="row">
        <div class="column">
          <h2 class="chart-title" style="color: white;">Rank Analysis Firearm Acquisition</h2>
          <iframe
            style="background: #FFFFFF;border: none;border-radius: 2px;box-shadow: 0 2px 10px 0 rgba(70, 76, 79, .2);"
            src="https://charts.mongodb.com/charts-project-0-omorz/embed/charts?id=6492afa8-e63f-4b36-8007-0f06bc0fceb5&maxDataAge=3600&theme=light&autoRefresh=true"></iframe>
        </div>

        <div class="column">
          <h2 class="chart-title" style="color: white;">Station Analysis</h2>
          <iframe
            style="background: #FFFFFF;border: none;border-radius: 2px;box-shadow: 0 2px 10px 0 rgba(70, 76, 79, .2);"
            src="https://charts.mongodb.com/charts-project-0-omorz/embed/charts?id=6492af4a-7081-435a-88d2-cbf173aa2add&maxDataAge=3600&theme=light&autoRefresh=true"></iframe>
        </div>

        Expand All
        @@ -73,24 +74,64 @@

        <div class="row">
          <div class="column">
            <h2 class="chart-title" style="color: white;">Gun Type Analysis</h2>
            <iframe
              style="background: #FFFFFF;border: none;border-radius: 2px;box-shadow: 0 2px 10px 0 rgba(70, 76, 79, .2);"
              src="https://charts.mongodb.com/charts-project-0-omorz/embed/charts?id=64a4e114-bfd6-4c5c-82e1-aed10e4d8504&maxDataAge=3600&theme=light&autoRefresh=true"></iframe>
          </div>

          <div class="column">
            <h2 class="chart-title" style="color: white;">Firearm Acquisition by Caliber</h2>
            <iframe
              style="background: #FFFFFF;border: none;border-radius: 2px;box-shadow: 0 2px 10px 0 rgba(70, 76, 79, .2);"
              src="https://charts.mongodb.com/charts-project-0-omorz/embed/charts?id=6499393e-5d6e-4d4b-80e6-5c0004764687&maxDataAge=3600&theme=light&autoRefresh=true"></iframe>
          </div>

        </div>


        <div class="row">
          <div class="column">
            <h2 class="chart-title" style="color: white;">QR Code Status</h2>
            <iframe
              style="background: #FFFFFF;border: none;border-radius: 2px;box-shadow: 0 2px 10px 0 rgba(70, 76, 79, .2);"
              
              src="https://charts.mongodb.com/charts-project-0-omorz/embed/charts?id=64a75be6-7fe0-4990-8c22-994ad4f608cf&maxDataAge=3600&theme=light&autoRefresh=true"></iframe>
          </div>

          <div class="column">
            <h2 class="chart-title" style="color: white;">Date Issuance Monitoring</h2>
            <iframe
              style="background: #FFFFFF;border: none;border-radius: 2px;box-shadow: 0 2px 10px 0 rgba(70, 76, 79, .2);"
              src="https://charts.mongodb.com/charts-project-0-omorz/embed/charts?id=64a7c276-7fe0-4399-846c-994ad42930fa&maxDataAge=3600&theme=light&autoRefresh=true"></iframe>
          </div>

        </div>


        <div class="row">
          <div class="column">
            <h2 class="chart-title" style="color: white;">Rank and Gun Type Analysis</h2>
            <iframe
              style="background: #FFFFFF;border: none;border-radius: 2px;box-shadow: 0 2px 10px 0 rgba(70, 76, 79, .2);"
              src="https://charts.mongodb.com/charts-project-0-omorz/embed/charts?id=64aa7bf4-2925-478c-8eff-15cc0ae2b5da&maxDataAge=3600&theme=light&autoRefresh=true"></iframe>
          </div>

          <div class="column">
            <h2 class="chart-title" style="color: white;">Gun Type by Rank</h2>
            <iframe
              style="background: #FFFFFF;border: none;border-radius: 2px;box-shadow: 0 2px 10px 0 rgba(70, 76, 79, .2);"
              src="https://charts.mongodb.com/charts-project-0-omorz/embed/charts?id=64aa808f-904b-4bad-810f-87a9d4d94c75&maxDataAge=3600&theme=light&autoRefresh=true"></iframe>
          </div>

        </div>


        <div class="row">
          <div class="column">
            <h2 class="chart-title" style="color: white;">Rank and Gun Type Analysis</h2>
            <iframe
              style="background: #FFFFFF;border: none;border-radius: 2px;box-shadow: 0 2px 10px 0 rgba(70, 76, 79, .2);"
              src="https://charts.mongodb.com/charts-project-0-omorz/embed/charts?id=64aa77c2-c709-44ca-809a-73a5bd6426e9&maxDataAge=3600&theme=light&autoRefresh=true"></iframe>
          </div>

          <div class="column">
            <h2 class="chart-title" style="color: white;">Gun Type by Rank</h2>
            <iframe
              style="background: #FFFFFF;border: none;border-radius: 2px;box-shadow: 0 2px 10px 0 rgba(70, 76, 79, .2);"
              src="https://charts.mongodb.com/charts-project-0-omorz/embed/charts?id=64a7c613-c709-43c3-8b0f-73a5bdd4f530&maxDataAge=3600&theme=light&autoRefresh=true"></iframe>
          </div>

        </div>


        <div class="row">
          <div class="column">
            <h2 class="chart-title" style="color: white;">Rank and Gun Type Analysis</h2>
            <iframe style="background: #FFFFFF;border: none;border-radius: 2px;box-shadow: 0 2px 10px 0 rgba(70, 76, 79, .2);" src="https://charts.mongodb.com/charts-project-0-omorz/embed/charts?id=649937ab-6ccc-47e8-8431-13e80f87ab31&maxDataAge=3600&theme=light&autoRefresh=true"></iframe>
          </div>

          <div class="column">
            <h2 class="chart-title" style="color: white;">Gun Type by Rank</h2>
            <iframe style="background: #FFFFFF;border: none;border-radius: 2px;box-shadow: 0 2px 10px 0 rgba(70, 76, 79, .2);" src="https://charts.mongodb.com/charts-project-0-omorz/embed/charts?id=64aa6838-5bfe-4e8d-82ec-be414ef2ae74&maxDataAge=3600&theme=light&autoRefresh=true"></iframe>
          </div>

        </div>
        
        <div class="row">
          <div class="column">
            <center>
            <h2 class="chart-title" style="color: white;">TURN OVER RATE</h2>
           <canvas id="myChart" class="myChart" style="background: #FFFFFF;border: none;border-radius: 2px;box-shadow: 0 2px 10px 0 rgba(70, 76, 79, .2);" ></canvas>
          </center>
          </div>
        </div>
        

      <div class="column">
        <center><h2 class="chart-title" style="color: white; ">Days for next inspection will be in <%= daysLeft %> days </h2></center>
      </div>


    </div>
    <h1 class="white"></h1>


    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const firearms = <%= firearms %>;
        const countTurnedOver = <%= countTurnedOver %>;
        const countNotTurnedOver = <%= countNotTurnedOver %>;

        const ctx = document.getElementById('myChart').getContext('2d');
        const myChart = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: ['Firearms ' + firearms, 'Turned Over ' + countTurnedOver, 'Not Turned Over ' + countNotTurnedOver],
            datasets: [{
              label: 'Firearms and those who Turned Over and Not Turned Over',
              data: [firearms, countTurnedOver, countNotTurnedOver],
              backgroundColor: [
                'rgba(54, 162, 235, 0.5)', // Firearms - Blue
                'rgba(65, 105, 225)', // Turned Over - Green
                'rgba(0,0,255)', // Not Turned Over - Red
              ],
              borderColor: [
                'rgba(54, 162, 235, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(255, 99, 132, 1)',
              ],
              borderWidth: 1
            }]
          },
          options: {
            scales: {
              y: {
                beginAtZero: true
              }
            }
          }
        });
      });
    </script>

</body>

</html>