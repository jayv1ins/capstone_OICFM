<header>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <%- include('../components/navbar') %>

</header>
<center>
  <h1>Select Date Range for Acquisition</h1>
  <form action="/DataTable" method="GET" onsubmit="handleFilterSubmit(event)">
    <label for="startDate">Start Date:</label>
    <input type="date" id="startDate" name="startDate" required>
  
    <label for="endDate">End Date:</label>
    <input type="date" id="endDate" name="endDate" required>

    <button type="submit">Submit</button>
    <button type="reset">Reset</button>
  </form>
  
  <form action="/DataTable" method="GET" onsubmit="handleFilterSubmit(event)">
    <label for="searchQuery">Search:</label>
    <input type="text" id="searchQuery" name="search" list="searchSuggestions" placeholder="Enter name or gun name" <% if (searchQuery) { %>value="<%- searchQuery %>"<% } %>>
    <datalist id="searchSuggestions">
      <% suggestions.forEach(function(suggestion) { %>
        <option value="<%- suggestion %>">
      <% }); %>
    </datalist>
  </form>
  
  
</center>
<body>
  <div class="container table-responsive py-5"> 
    <table class="table table-bordered table-hover">
      <thead class="thead-dark">
        <tr>
          <th scope="col">#</th>
          <th scope="col">Full Name</th>
          <th scope="col">Rank</th>
          <th scope="col">Gun Type</th>
          <th scope="col">Gun Name</th>
          <th scope="col">Serial ID</th>
          <th scope="col">Caliber</th>
          <th scope="col">Cost</th>
          <th scope="col">Station</th>
          <!-- <th scope="col">Check in</th>
          <th scope="col">Check Out</th> -->
          <th scope="col">Qr</th>
          <th scope="col">Actions</th>
        </tr>
      </thead>  
      <tbody>
        <% if (datas.length > 0) { %>
          <% let counter = (page - 1) * limit + 1; %>
          <% datas.forEach(function(data) { %>
            <tr>
              <td><%= counter %></td>
              <td><%= data.lastName %>, <%= data.firstName %> . <%= data.middleName %></td>
              <td><%= data.rank %></td>
              <td><%= data.Gtype %></td>
              <td><%= data.Gname %></td>
              <td><%= data.serialN %></td>
              <td><%= data.caliber %></td>
              <td><%= data.cost %></td>
              <td><%= data.station %></td>
              <td>
              <% if (data.hasQRCode) { %>
                <div class="qr-code-container">
                  <!-- Display the QR code here -->
                  <img src="<%= `data:image/png;base64,${data.qrCode.toString('base64')}` %>" alt="QR Code" />
                </div>
              <% } else { %>
                <p>No QR Code available</p>
              <% } %>
              </td>
      
              <td>
                <a href="/select/<%= data.id %>">select</a>
                <a href="/edit/<%= data.id %>">Edit</a>
                <form action="/delete/<%= data.id %>" method="POST">
                  <button type="submit">Delete</button>
                </form>
              </td>
            </tr>
            <% counter++; %>
          <% }); %>
        <% } else { %>
          <p>No data found.</p>
        <% } %>
      </tbody>
      
    </table>

    <div class="flex justify-between items-center mt-5">
      <div>
        <span class="text-sm text-gray-700">
          Showing <%= (page - 1) * limit + 1 %>-<%= Math.min(page * limit, totalRecords) %> of <%= totalRecords %>
        </span>
      </div>
      <div>
        <nav class="inline-flex rounded-md shadow">
          <% if (page > 1) { %>
            <a href="/DataTable?page=<%= page - 1 %>" class="px-3 py-1 rounded-l-md bg-blue-500 text-white">
              Previous
            </a>
          <% } %>
    
          <% for (let i = 1; i <= totalPages; i++) { %>
            <% if (page === i) { %>
              <span class="px-3 py-1 bg-white text-blue-500 hover:bg-blue-500 hover:text-white"><%= i %></span>
            <% } else { %>
              <a href="/DataTable?page=<%= i %>" class="px-3 py-1 bg-white text-blue-500 hover:bg-blue-500 hover:text-white"><%= i %></a>
            <% } %>
          <% } %>
    
          <% if (page < totalPages) { %>
            <a href="/DataTable?page=<%= page + 1 %>" class="px-3 py-1 bg-white text-blue-500 hover:bg-blue-500 hover:text-white">
              Next
            </a>
          <% } %>
        </nav>
      </div>
    </div>

  <div class="text-center mt-5">
    <a class="btn btn-primary" href="/create" role="button">Create New Details</a>
  </div>
</div>
</div>


</body>

